# Лабораторная работа №6: Моделирование Kill-chain процедур (выполнили: Брусило Даниил, Рыжков Егор, Капустянский Олег, 21-К-АС2)

## 1. Теоретическая часть
Kill Chain (Цепочка уничтожения) — модель, описывающая этапы целевой кибератаки от разведки до достижения цели. Разработана Lockheed Martin для систематизации защиты. Основная идея: если разорвать цепочку на любом этапе, атака будет остановлена.

## 2. Лабораторный стенд
Атакующая система: Kali Linux (IP: 192.168.31.8)
![](/source/14.png)
Целевая система: Windows Server 2019 Datacenter (IP: 192.168.31.168)
![](/source/15.png)
Выбор ОС: Windows Server 2019 выбран как типичная корпоративная серверная ОС, часто являющаяся целью атак из-за хранимых данных и сервисов.
Сетевая настройка: Обе виртуальные машины находятся в одной изолированной сети (Host-Only).
Состояние защиты: Антивирусное ПО и брандмауэр Windows на целевой машине отключены для наглядности демонстрации.

## 3. Практическая часть

### Этап 1: Разведка (Reconnaissance)
Цель этапа: Сбор информации о целевой машине: IP-адрес, открытые порты, запущенные службы.
Выполненные действия: С помощью утилиты Nmap на Kali Linux выполнено сканирование целевого IP-адреса.
![](/source/1.png)
Контрмеры:
- Сегментация сети для скрытия инфраструктуры.
- Настройка межсетевых экранов для фильтрации сканирующих запросов.
- Регулярный аудит открытых портов и ненужных служб.

### Этап 2: Создание оружия (Weaponization)
Цель этапа: Подготовка вредоносного инструмента для атаки.
Выполненные действия: С помощью инструмента msfvenom в Kali Linux создан исполняемый файл (payload.exe), содержащий полезную нагрузку типа reverse_tcp.
![](/source/2.png)
Контрмеры (как исправить/защититься):
- Применение Endpoint Detection and Response (EDR) систем.
- Анализ поведения приложений (Application Whitelisting).
- Использование песочниц (Sandbox) для проверки подозрительных файлов.

### Этап 3: Доставка (Delivery)
Цель этапа: Транспортировка вредоносного файла на целевую систему.
Выполненные действия: Файл updater.exe был доставлен на целевую машину Windows Server вручную путем его копирования через общую папку виртуальной среды, что имитирует, например, загрузку пользователем вложения из фишингового письма.
![](/source/3.png)
![](/source/4.png)

После попытки скачать файл, веб-браузер начал ругаться, что файл может содержать опасность.
![](/source/5.png)
![](/source/6.png)

Контрмеры (как исправить/защититься):
- Обучение пользователей кибергигиене (распознаванию фишинга).
- Использование почтовых шлюзов с антивирусной проверкой.
- Блокировка исполняемых файлов в почтовых вложениях.

### Этап 4: Эксплуатация (Exploitation) и Этап 5: Установка (Installation)
Цель этапа: Исполнение вредоносного кода и закрепление в системе.
Выполненные действия:
1. На Kali Linux с помощью фреймворка Metasploit запущен обработчик (handler), ожидающий обратного соединения.
![](/source/9.png)
2. На Windows Server пользователь, после того, как разрешил скачивание файла, запустил файл updater.exe, подтвердив запрос UAC.
![](/source/7.png)
![](/source/8.png)
3. Было установлено обратное соединение, и в Metasploit открылась сессия Meterpreter, что означает успешную эксплуатацию и установку зловреда в память.
Контрмеры (как исправить/защититься):
- Своевременное обновление ПО и установка патчей.
- Принцип наименьших привилегий для учетных записей.
- Запрет на выполнение кода из временных каталогов.

### Этап 6: Установление командования и управления (Command & Control, C2)
Цель этапа: Обеспечение канала для управления скомпрометированной системой.
Выполненные действия: В открытой сессии Meterpreter выполнена команда whoami для проверки учетной записи. Команда успешно выполнилась и вернула имя администратора, подтвердив стабильность C2-канала.
![](/source/10.png)
Контрмеры (как исправить/защититься):
- Мониторинг сетевого трафика на предмет аномальных исходящих соединений.
- Использование систем NDR и блокировка связи с известными адресами C2-серверов.
- Применение DNS-фильтрации.

### Этап 7: Действия по достижению цели (Actions on Objectives)
Цель этапа: Выполнение финальных задач атаки.
Выполненные действия: С использованием полученного доступа были выполнены следующие действия:
1. Сбор детальной информации о системе с помощью команды systeminfo.
![](/source/11.png)
2. Чтение содержимого критического системного файла C:\Windows\System32\drivers\etc\hosts.
![](/source/12.png)
3. Исследование корневого каталога файловой системы командой dir C:\.
![](/source/13.png)
Контрмеры (как исправить/защититься):
- Внедрение систем защиты от утечек данных (DLP).
- Строгий контроль доступа к критически важным файлам и папкам.
- Активный мониторинг действий привилегированных учетных записей.
- Регулярное резервное копирование.

## 4. Ответы на контрольные вопросы
1. Дайте определение модели Kill Chain (Цепочки уничтожения) в контексте кибербезопасности. — Это модель, описывающая последовательные этапы кибератаки от начальной разведки до достижения конечной цели, используемая для построения систем защиты.
2. Кто и с какой целью разработал классическую модель Cyber Kill Chain? — Её разработала компания Lockheed Martin с целью систематизации этапов атаки для создания более эффективной обороны.
3. Перечислите все семь этапов классической модели Cyber Kill Chain по порядку. — 1. Разведка, 2. Создание оружия, 3. Доставка, 4. Эксплуатация, 5. Установка, 6. Командование и управление (C2), 7. Действия по достижению цели.
4. Какова основная оборонительная идея модели Kill Chain? — Идея в том, что для срыва атаки защищающейся стороне достаточно разорвать цепочку на любом из этапов.
5. На каком этапе Kill Chain происходит отправка фишингового письма? — На этапе "Доставка".
6. Что такое этап "Установление командования и управления" (C2)? Почему он критически важен для злоумышленника? — Это этап установки канала связи с compromised-системой. Он критически важен, так как без него злоумышленник не может управлять вредоносным ПО и выполнять дальнейшие действия.
7. Приведите пример контрмеры на этапе "Доставка". — Обучение пользователей, антиспам-фильтры, блокировка опасных вложений.
8. Опишите сценарий атаки с использованием ransomware (шифровальщика) через призму этапов Kill Chain. — 1. Разведка: поиск уязвимой компании. 2. Создание оружия: написание/покупка шифровальщика. 3. Доставка: рассылка фишинговых писем. 4. Эксплуатация: запуск макроса в документе. 5. Установка: инсталляция шифровальщика в систему. 6. C2: соединение с сервером для получения ключа. 7. Действия: шифрование файлов и вывод требования выкупа.
9. Почему этапы "Доставка" и "Эксплуатация" считаются одними из самых эффективных для обороны? — Потому что на этих этапах злоумышленник непосредственно взаимодействует с защищаемой средой, и у обороны есть физическая возможность блокировать вредоносные файлы или запросы.
10. В чем заключаются основные ограничения и недостатки классической модели Cyber Kill Chain? — Линейность модели (атаки могут быть нелинейными), плохое описание инсайдерских угроз, слабое освещение перемещения внутри сети после взлома.
11. Объясните, как модель Kill Chain используется при расследовании киберинцидентов. — Она используется для реконструкции атаки, определения точки входа, используемых техник, масштаба ущерба и для поиска артефактов в системе.
12. В чем разница между этапами "Эксплуатация" и "Установка"? — "Эксплуатация" — это использование уязвимости для первоначального выполнения кода. "Установка" — это закрепление присутствия, например, установка постоянного бэкдора.
13. Сравните этап "Разведка" в Kill Chain и тактику "Сбор информации" в модели MITRE ATT&CK. Что общего и в чем различие? — Общее: цель — сбор сведений о цели. Различие: в ATT&CK "Сбор информации" — это одна из многих тактик, не привязанная строго к началу линейной цепочки; модель описывает конкретные техники сбора.
14. Как концепция "Обороны в глубину" (Defense in Depth) связана с моделью Kill Chain? — Концепция "Обороны в глубину" реализуется через выстраивание контрмер на каждом этапе Kill Chain, создавая многоуровневую защиту.
15. Почему инсайдерская угроза плохо описывается классической моделью Kill Chain? Приведите пример. — Потому что этапы "Доставка" и "Эксплуатация" часто отсутствуют. Пример: недовольный сотрудник и так имеет легитимный доступ к данным и может сразу скопировать их на USB-накопитель (этап "Действия по достижению цели"), минуя предыдущие шаги.

## 5. Выводы
В ходе лабораторной работы была смоделирована кибератака по модели Kill Chain, успешно пройдены все семь этапов. Работа наглядно продемонстрировала, как последовательные действия злоумышленника приводят к полному компрометированию системы. Были рассмотрены контрмеры для каждого этапа, что подтверждает практическую ценность модели Kill Chain для построения эшелонированной защиты (Defense in Depth).
